#
# DO NOT MODIFY THIS FILE.
#
# This file is auto generated by Ansible.
#

from {{ django_project }}.settings_django import *

# Debug
DEBUG = {{ django_combined.debug }}
{% if django_combined.debug %}
INTERNAL_IPS = ['127.0.0.1']

EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'
AUTH_PASSWORD_VALIDATORS = []
{% endif %}

# Security
ALLOWED_HOSTS = [{% for host in domains %}'{{ host }}'{% if not loop.last %}, {% endif %}{% endfor %}]
SECRET_KEY = '{{ secret_key }}'

# Static
STATIC_ROOT = '{{ dir_static }}'
STATIC_URL = '{{ static_url }}'
STATICFILES_DIRS = []

# Media
MEDIA_ROOT = '{{ dir_media }}'
MEDIA_URL = '{{ media_url }}'
FILE_UPLOAD_PERMISSIONS = 0o644

# URLs
{% if django_combined.debug %}
BASE_URL = 'http://localhost:{{ django_combined.port }}'
{% elif nginx_combined.https %}
BASE_URL = 'https://{{ domains[0] }}'
{% else %}
BASE_URL = 'http://{{ domains[0] }}'
{% endif %}

{% if nginx_combined.https %}
# Security
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')
{% endif %}

# Helper functions to be used by the mods
def insert(items, name, before=None, after=None):
    assert type(items) is list
    assert type(name) is str
    assert not (before and after)

    if before is None and after is None:
        after = items[-1]

    i = items.index(before) if before else items.index(after) + 1
    items.insert(i, name)

{% for mod in mods_settings %}
# {{ mod }}/settings.py
{{ lookup('template', '../' + mod + '/settings.py') }}
{% endfor %}
