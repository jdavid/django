"""
This file is auto-generated by Ansible, do not modify it.
"""

from {{ django_project }}.settings import *

{% if database.engine == 'default' %}
{% elif database.engine == 'postgres' %}
# Database
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': '{{ database.name }}',
        'USER': '{{ database.user }}',
        'PASSWORD': '{{ database.password }}',
        'HOST': '{{ database.host|default() }}',    # Set to empty string for localhost.
        'PORT': '',                                 # Set to empty string for default.
    }
}
{% endif %}

# Debug
DEBUG = {{ django_combined.debug }}
{% if django_combined.debug %}
INTERNAL_IPS = ['127.0.0.1']

EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'
AUTH_PASSWORD_VALIDATORS = []
{% endif %}

# Security
ALLOWED_HOSTS = [{% for host in domains %}'{{ host }}'{% if not loop.last %}, {% endif %}{% endfor %}]
SECRET_KEY = '{{ secret_key }}'

# Static
STATIC_ROOT = '{{ dir_static }}'
STATIC_URL = '{{ static_url }}'

# Media
MEDIA_ROOT = '{{ dir_media }}'
MEDIA_URL = '{{ media_url }}'
FILE_UPLOAD_PERMISSIONS = 0o644

# URLs
{% if django_combined.debug %}
BASE_URL = 'http://localhost:{{ django_combined.port }}'
{% elif nginx_combined.https %}
BASE_URL = 'https://{{ domains[0] }}'
{% else %}
BASE_URL = 'http://{{ domains[0] }}'
{% endif %}

{% if cache.backend == 'default' %}
{% elif cache.backend == 'memcached' %}
# Cache
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.memcached.PyMemcacheCache',
        'LOCATION': '{{ cache.location }}',
    }
}

SESSION_ENGINE = 'django.contrib.sessions.backends.cached_db'
{% endif %}

{% if nginx_combined.https %}
# Security
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')
{% endif %}

{% if mods is defined %}
# Modules
def execfile(location, name):
    with (Path(location) / name).open() as file:
        exec(file.read(), globals())

{% for mod in mods %}
execfile("{{ mod }}".replace('.', '/'), 'settings.py')
{% endfor %}
{% endif %}
